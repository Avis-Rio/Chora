# Vercel éƒ¨ç½²æŒ‡å—

## ğŸ” ç¯å¢ƒå˜é‡é…ç½®

åœ¨ Vercel é¡¹ç›®è®¾ç½® (Settings â†’ Environment Variables) ä¸­æ·»åŠ ä»¥ä¸‹å˜é‡ï¼š

| å˜é‡å | è¯´æ˜ | æ¥æº |
|--------|------|------|
| `FEISHU_APP_ID` | é£ä¹¦åº”ç”¨ ID | é£ä¹¦å¼€æ”¾å¹³å° |
| `FEISHU_APP_SECRET` | é£ä¹¦åº”ç”¨å¯†é’¥ | é£ä¹¦å¼€æ”¾å¹³å° |
| `FEISHU_BASE_ID` | å¤šç»´è¡¨æ ¼ Base ID | è¡¨æ ¼ URL ä¸­çš„ `base/xxx` |
| `FEISHU_TABLE_ID` | æ•°æ®è¡¨ ID | è¡¨æ ¼ URL ä¸­çš„ `table=xxx` |

> âš ï¸ **å®‰å…¨æé†’**ï¼šè¯·åœ¨ Vercel åå°ç›´æ¥é…ç½®ï¼Œä¸è¦æäº¤åˆ° Gitã€‚

---

## ğŸ“¦ éƒ¨ç½²æ­¥éª¤

### 1. æ¨é€ä»£ç åˆ° GitHub
```bash
git add .
git commit -m "Deploy to Vercel"
git push
```

### 2. è¿æ¥ Vercel
1. è®¿é—® [vercel.com](https://vercel.com)
2. Import Git Repository â†’ é€‰æ‹© `Chora` ä»“åº“
3. **Root Directory**: `frontend`
4. ç‚¹å‡» Deploy

### 3. é…ç½®ç¯å¢ƒå˜é‡
1. Project Settings â†’ Environment Variables
2. æ·»åŠ ä¸Šè¿° 4 ä¸ªå˜é‡
3. **é‡æ–°éƒ¨ç½²** (Deployments â†’ Redeploy)

---

## ğŸ“ é¡¹ç›®ç»“æ„

```
frontend/
â”œâ”€â”€ api/
â”‚   â”œâ”€â”€ content.js    # é£ä¹¦æ•°æ® API
â”‚   â””â”€â”€ image.js      # å°é¢å›¾ä»£ç† API
â”œâ”€â”€ index.html
â”œâ”€â”€ app.js
â”œâ”€â”€ styles.css
â”œâ”€â”€ fonts/
â””â”€â”€ vercel.json
```

---

## ğŸ”„ æ•°æ®æµæ¶æ„

```
é£ä¹¦å¤šç»´è¡¨æ ¼ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ Vercel API
                                              â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                                    â†“                                    â”‚
         â”‚   /api/content                     â”‚               /api/image           â”‚
         â”‚   - è·å–é£ä¹¦ access_token           â”‚               - ä»£ç†é£ä¹¦å›¾ç‰‡ä¸‹è½½     â”‚
         â”‚   - æ‹‰å– Bitable è®°å½•               â”‚               - æ·»åŠ è®¤è¯ header     â”‚
         â”‚   - è½¬æ¢å°é¢ URL ä¸ºä»£ç†æ ¼å¼          â”‚               - è¿”å›å›¾ç‰‡äºŒè¿›åˆ¶       â”‚
         â”‚                                    â†“                                    â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                              â”‚
                                      å‰ç«¯ (app.js)
                                              â”‚
                                         ç”¨æˆ·æµè§ˆå™¨
```

---

## ğŸ› ï¸ æ•…éšœæ’é™¤è®°å½•

### é—®é¢˜ 1: API è¿”å› 404 NOT_FOUND

**ç°è±¡**ï¼šè®¿é—® `/api/content` è¿”å› 404

**åŸå› **ï¼šVercel è¦æ±‚é™æ€æ–‡ä»¶å’Œ `api/` ç›®å½•åœ¨åŒä¸€å±‚çº§ã€‚åŸé¡¹ç›®ç»“æ„ `frontend/public/` å­ç›®å½•å¯¼è‡´ API å‡½æ•°æ— æ³•è¢«è¯†åˆ«ã€‚

**è§£å†³æ–¹æ¡ˆ**ï¼š
```diff
- frontend/
-   â”œâ”€â”€ api/
-   â””â”€â”€ public/
-       â”œâ”€â”€ index.html
-       â””â”€â”€ app.js

+ frontend/
+   â”œâ”€â”€ api/
+   â”œâ”€â”€ index.html
+   â””â”€â”€ app.js
```

---

### é—®é¢˜ 2: vercel.json runtime é…ç½®æŠ¥é”™

**ç°è±¡**ï¼š`Error: Function Runtimes must have a valid version`

**åŸå› **ï¼šæ—§ç‰ˆ `vercel.json` ä¸­çš„ `runtime: "nodejs18.x"` æ ¼å¼ä¸è¢«æ–°ç‰ˆ Vercel æ”¯æŒã€‚

**è§£å†³æ–¹æ¡ˆ**ï¼šç®€åŒ– `vercel.json`ï¼š
```json
{
  "buildCommand": "",
  "outputDirectory": "."
}
```

---

### é—®é¢˜ 3: å°é¢å›¾æ— æ³•æ˜¾ç¤º

**ç°è±¡**ï¼šæ–‡ç« å¡ç‰‡å°é¢åŒºåŸŸæ˜¾ç¤ºç©ºç™½/å›¾ç‰‡æ— æ³•åŠ è½½

**åŸå› **ï¼šé£ä¹¦é™„ä»¶ä¸‹è½½ URL éœ€è¦ `Authorization: Bearer {token}` è®¤è¯ï¼Œæµè§ˆå™¨ç›´æ¥è®¿é—®ä¼šè¢«æ‹’ç»ã€‚

**è§£å†³æ–¹æ¡ˆ**ï¼šåˆ›å»ºå›¾ç‰‡ä»£ç† API (`api/image.js`)ï¼š
1. æ¥æ”¶ `token` å‚æ•°
2. ä½¿ç”¨é£ä¹¦ access_token ä¸‹è½½å›¾ç‰‡
3. è¿”å›å›¾ç‰‡äºŒè¿›åˆ¶ç»™å‰ç«¯

```javascript
// åŸå§‹ URL (éœ€è®¤è¯ï¼Œå‰ç«¯æ— æ³•è®¿é—®)
https://open.feishu.cn/open-apis/drive/v1/medias/{token}/download

// ä»£ç† URL (ç»è¿‡åç«¯è®¤è¯ï¼Œå‰ç«¯å¯è®¿é—®)
/api/image?token={token}
```

---

### é—®é¢˜ 4: é¢„è§ˆéƒ¨ç½²éœ€è¦ç™»å½•

**ç°è±¡**ï¼šPreview éƒ¨ç½²æ˜¾ç¤º Vercel Authentication é¡µé¢

**åŸå› **ï¼šVercel é»˜è®¤å¯¹é Production éƒ¨ç½²å¯ç”¨èº«ä»½éªŒè¯ä¿æŠ¤

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. Project Settings â†’ Deployment Protection
2. å°† Vercel Authentication è®¾ä¸º Disabled
3. æˆ–ä½¿ç”¨ Production åŸŸåè®¿é—®

---

## ğŸ§ª æœ¬åœ°å¼€å‘

```bash
# æ–¹å¼ 1: é™æ€æœåŠ¡å™¨ (API å›é€€åˆ°é™æ€ JSON)
cd frontend
python3 -m http.server 8081

# æ–¹å¼ 2: Vercel CLI (æ”¯æŒ API å‡½æ•°)
npm i -g vercel
cd frontend
vercel dev
```

---

## âœ… éªŒè¯æ¸…å•

- [ ] ç¯å¢ƒå˜é‡å·²é…ç½® (4ä¸ª)
- [ ] ç¯å¢ƒå˜é‡é…ç½®åå·²é‡æ–°éƒ¨ç½²
- [ ] è®¿é—® `/api/content` è¿”å› JSON æ•°æ®
- [ ] è®¿é—® `/api/image?token=xxx` è¿”å›å›¾ç‰‡
- [ ] é¦–é¡µæ–‡ç« åˆ—è¡¨æ­£å¸¸æ˜¾ç¤º
- [ ] æ–‡ç« å°é¢å›¾æ­£å¸¸æ˜¾ç¤º
- [ ] ç‚¹å‡»æ–‡ç« å¯è¿›å…¥è¯¦æƒ…é¡µ

---

**ç”Ÿäº§åŸŸå**: `https://chora-wheat.vercel.app`
